<Window x:Class="StreamerBot.StreamerBotWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:GUI="clr-namespace:StreamerBotLib.GUI;assembly=TwineStreamerBotLib"
        xmlns:Models="clr-namespace:StreamerBotLib.Models;assembly=TwineStreamerBotLib"
        xmlns:s="clr-namespace:StreamerBotLib.Properties;assembly=TwineStreamerBotLib"
        xmlns:Static="clr-namespace:StreamerBotLib.Static;assembly=TwineStreamerBotLib"
        xmlns:Enums="clr-namespace:StreamerBotLib.Enums;assembly=TwineStreamerBotLib"
        mc:Ignorable="d"
        Title="Streamer Bot Manager" Height="770" Width="1020"
        Loaded="Window_Loaded" Closing="OnWindowClosing" UseLayoutRounding="True">
    <Window.Resources>
        <ResourceDictionary>
            <GUI:GUITwitchBots x:Name="TwitchBot" x:Key="TwitchBot" />
            <GUI:GUIDataManagerViews x:Name="DataViews" x:Key="DataViews" />
            <GUI:GUIAppStats x:Name="AppStats" x:Key="AppStats" />
            <Static:MsgVarHelp x:Name="CommandInfo" x:Key="CommandInfo" />
            <Models:IndexConverter x:Name="IndexConverter" x:Key="IndexConverter" />
            <Models:StatValueConverter x:Name="AppDataConverter" x:Key="AppDataConverter" />
            <Enums:ViewerTypesString x:Name="ViewerTypesString" x:Key="ViewerTypesString" />
            <ContextMenu x:Key="DataGrid_ContextMenu" Name="DataGrid_ContextMenu">
                <MenuItem x:Name="DataGridContextMenu_AddItem"  Header="Add New Row" Click="MenuItem_AddClick" />
                <MenuItem x:Name="DataGridContextMenu_EditItem" Header="Edit Selected Row" Click="MenuItem_EditClick" />
                <MenuItem x:Name="DataGridContextMenu_DeleteItems" Header="Delete Selected Row(s)" Click="MenuItem_DeleteClick" ToolTip="Delete 1 or more rows, not for preset tables. No warning messages."/>
                <Separator x:Name="DataGridContextMenu_Separator" />
                <MenuItem x:Name="DataGridContextMenu_AutoShout" Header="Add User to AutoShout list" ToolTip="Does not Duplicate" Visibility="Collapsed" Click="MenuItem_AutoShoutClick"/>
            </ContextMenu>

            <Style TargetType="{x:Type DockPanel}">
                <Setter Property="Margin" Value="5" />
            </Style>
            <Style TargetType="{x:Type RadioButton}">
                <Setter Property="Margin" Value="10,5,0,5" />
                <EventSetter Event="Click" Handler="CheckBox_Click_SaveSettings" />
            </Style>
            <Style TargetType="{x:Type TabItem}">
                <Setter Property="MinWidth" Value="50" />
                <Setter Property="Height" Value="30" />
            </Style>
            <Style TargetType="{x:Type GroupBox}">
                <Setter Property="Margin" Value="5" />
                <Setter Property="Width" Value="230" />
                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                <Setter Property="BorderBrush" Value="#FF212D34" />
            </Style>
            <Style TargetType="{x:Type CheckBox}">
                <Setter Property="Margin" Value="5" />
                <EventSetter Event="Click" Handler="CheckBox_Click_SaveSettings" />
            </Style>
            <Style TargetType="{x:Type TextBlock}">
                <Setter Property="TextWrapping" Value="Wrap" />
                <Setter Property="Padding" Value="5,0" />
            </Style>
            <Style TargetType="{x:Type DataGrid}">
                <Setter Property="AlternationCount" Value="1" />
                <Setter Property="AlternatingRowBackground" Value="#FFDBFFF4"/>
                <Setter Property="ScrollViewer.CanContentScroll" Value="True" />
                <Setter Property="AutoGenerateColumns" Value="True" />
                <Setter Property="CanUserAddRows" Value="False" />
                <Setter Property="CanUserDeleteRows" Value="True" />
                <Setter Property="ContextMenu" Value="{DynamicResource DataGrid_ContextMenu}"/>
                <Setter Property="IsReadOnly" Value="True" />
                <EventSetter Event="MouseDoubleClick" Handler="DG_MouseDoubleClick" />
            </Style>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Culture/GUI_Msgs.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <DockPanel>
        <StatusBar DockPanel.Dock="Bottom" DataContext="{Binding Mode=OneWay, Source={StaticResource DataViews}}">
            <StatusBar.Resources>
                <Style TargetType="StackPanel">
                    <Setter Property="Orientation" Value="Horizontal" />
                </Style>
            </StatusBar.Resources>
            <StatusBarItem>
                <StackPanel>
                    <Label ToolTip="All Users who visited the stream while online.">All Viewers:</Label>
                    <Label Content="{Binding Users.Count, NotifyOnSourceUpdated=True, StringFormat=\{0:N\}}" />
                </StackPanel>
            </StatusBarItem>
            <Separator Width="1" />
            <StatusBarItem>
                <Button Click="StatusBar_Button_UpdateFollows_Click">
                    <StackPanel>
                        <Label>
                            <Label.ToolTip>
                                <TextBlock>Click here to refresh now. Use 'Options' to manage followers, including regular updates, does not update immediately for unfollow.</TextBlock>
                            </Label.ToolTip>
                            <Label.Content>Curr Follows:</Label.Content>
                        </Label>
                        <Label Content="{Binding CurrFollowers, NotifyOnSourceUpdated=True, StringFormat=\{0:N\}}" />
                    </StackPanel>
                </Button>
            </StatusBarItem>
            <Separator Width="1" />
            <StatusBarItem>
                <StackPanel>
                    <Label ToolTip="Built-in Commands">Built-in Coms:</Label>
                    <Label Content="{Binding BuiltInCommands.Count, NotifyOnSourceUpdated=True, StringFormat=\{0:N\}}" />
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem>
                <StackPanel>
                    <Label ToolTip="User-Defined Commands">User-Def Coms:</Label>
                    <Label Content="{Binding Commands.Count, NotifyOnSourceUpdated=True, StringFormat=\{0:N\}}" />
                </StackPanel>
            </StatusBarItem>
            <Separator Width="1" />
            <StatusBarItem>
                <StackPanel>
                    <Label ToolTip="The earliest token expiration date.">Token Exp:</Label>
                    <Label x:Name="StatusBarItem_TokenDate"  />
                </StackPanel>
            </StatusBarItem>
            <Separator Width="1" />
            <StatusBarItem Padding="0,0,0,0">
                <Button Name="Button_RefreshCategory" Grid.Column="0" 
                        HorizontalAlignment="Left" VerticalAlignment="Center" 
                        Padding="0" Click="Button_RefreshCategory_Click" ToolTip="Click to refresh" Background="#FFDEF4FF">
                    <StackPanel>
                        <Label>Current Category:</Label>
                        <TextBlock x:Name="TextBlock_CurrentCategory" Grid.Column="2" VerticalAlignment="Center" TextWrapping="Wrap" Padding="0,0,5,0"/>
                    </StackPanel>
                </Button>
            </StatusBarItem>
        </StatusBar>
        <TabControl DockPanel.Dock="Top" TabStripPlacement="Left">
            <TabItem Header="Bots">
                <TabControl>
                    <TabItem Header="Start Bots">
                        <StackPanel>
                            <TextBlock>The bot credentials form needs to be completed with at least client id and access token.<LineBreak />The LiveStreamMonitor Service will allow monitoring multiple channels if the &quot;MultiUserLiveBot&quot; is running or started, but functionality <LineBreak />stops when the separate "MultiUserLiveBot" process starts.
                                    <LineBreak />For optimal operation, don't turn start and stop the bots rapidly - allow some time between each operation.
                            </TextBlock>
                            <WrapPanel HorizontalAlignment="Center">
                                <GroupBox Header="LiveStream Monitor Service">
                                    <StackPanel Orientation="Vertical">
                                        <WrapPanel>
                                            <Label x:Name="Label_TwitchMultiLive_Start" Foreground="Green" Visibility="Collapsed">
                                                <TextBlock>The Twitch LiveStream Monitor Client is started!</TextBlock>
                                            </Label>
                                            <Label x:Name="Label_TwitchMultiLive_Stop" Foreground="Maroon" Visibility="Visible">
                                                <TextBlock>The Twitch LiveStream Monitor Client is stopped!</TextBlock>
                                            </Label>
                                            <CheckBox DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" IsChecked="{Binding TwitchLiveStreamSvcAutoStart}" >
                                                <TextBlock>Auto-start when application starts</TextBlock>
                                            </CheckBox>
                                            <RadioButton DataContext="{Binding TwitchLiveMonitor, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_LiveBotStart" Content="Start Live Monitor Bot" IsEnabled="False" PreviewMouseLeftButtonDown="RadioButton_StartBot_PreviewMoustLeftButtonDown" Checked="Radio_Twitch_LiveBotStart_Checked"/>
                                            <RadioButton DataContext="{Binding TwitchLiveMonitor, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_LiveBotStop" Content="Stop Live Monitor Bot" IsEnabled="False" IsChecked="True" PreviewMouseLeftButtonDown="RadioButton_StopBot_PreviewMoustLeftButtonDown" Checked="Radio_Twitch_LiveBotStop_Checked"/>
                                            <Label x:Name="Label_TwitchMultiLive_Error" Foreground="Maroon" Visibility="Collapsed" Height="Auto">
                                                <TextBlock>The Twitch MultiLive Client failed to start! Check the Access Token Refresh Date and the Token Scope.</TextBlock>
                                            </Label>
                                        </WrapPanel>
                                        <GroupBox x:Name="GroupBox_Bots_Starts_MultiLive" Header="MultiLive Monitoring Bot" Width="Auto">
                                            <WrapPanel Orientation="Vertical">
                                                <Label x:Name="Label_LiveStream_MultiLiveActiveMsg" Foreground="Maroon" Visibility="Collapsed">
                                                    <TextBlock>The MultiUserLiveBot is active, single channel activated.</TextBlock>
                                                </Label>
                                                <CheckBox DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" IsChecked="{Binding TwitchMultiLiveAutoStart}">
                                                    <TextBlock>Auto-start when application starts</TextBlock>
                                                </CheckBox>
                                                <RadioButton x:Name="Radio_MultiLiveTwitch_StartBot" Content="Start Bot" IsEnabled="False" HorizontalAlignment="Left" PreviewMouseDown="BC_MultiLiveTwitch_BotOp"/>
                                                <RadioButton x:Name="Radio_MultiLiveTwitch_StopBot" Content="Stop Bot"  IsChecked="True" IsEnabled="False" Width="70" HorizontalAlignment="Left" PreviewMouseDown="BC_MultiLiveTwitch_BotOp"/>
                                            </WrapPanel>
                                        </GroupBox>
                                    </StackPanel>
                                </GroupBox>
                                <GroupBox Header="Follower Service">
                                    <WrapPanel>
                                        <Label x:Name="Label_TwitchFollow_Start" Foreground="Green" Visibility="Collapsed">
                                            <TextBlock TextWrapping="Wrap"><Run Text="The Twitch Follower Client is started!"/></TextBlock>
                                        </Label>
                                        <Label x:Name="Label_TwitchFollow_Stop" Foreground="Maroon" Visibility="Visible">
                                            <TextBlock TextWrapping="Wrap"><Run Text="The Twitch Follower Client is stopped!"/></TextBlock>
                                        </Label>
                                        <CheckBox DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" IsChecked="{Binding TwitchFollowerSvcAutoStart}">
                                            <TextBlock TextWrapping="Wrap"><Run Text="Auto-start when application starts"/></TextBlock>
                                        </CheckBox>
                                        <RadioButton DataContext="{Binding TwitchFollower, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_FollowBotStart" Content="Start Follower Service Bot" IsEnabled="False" PreviewMouseLeftButtonDown="RadioButton_StartBot_PreviewMoustLeftButtonDown" />
                                        <RadioButton DataContext="{Binding TwitchFollower, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_FollowBotStop" Content="Stop Follower Service Bot"  IsEnabled="False" IsChecked="True" PreviewMouseLeftButtonDown="RadioButton_StopBot_PreviewMoustLeftButtonDown" />
                                        <Label x:Name="Label_TwitchFollow_Error" Foreground="Maroon" Visibility="Collapsed" Height="Auto">
                                            <TextBlock>The Twitch Follow Client failed to start! Check the Access Token Refresh Date and the Token Scope.</TextBlock>
                                        </Label>
                                    </WrapPanel>
                                </GroupBox>
                                <GroupBox DockPanel.Dock="Top" x:Name="BC_T_groupBox" Header="ChatBot">
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label x:Name="Label_TwitchChat_Start" Foreground="Green" Visibility="Collapsed">
                                            <TextBlock>The Twitch Chat Client is started!</TextBlock>
                                        </Label>
                                        <Label x:Name="Label_TwitchChat_Stop" Foreground="Maroon" Visibility="Visible">
                                            <TextBlock>The Twitch Chat Client is stopped!</TextBlock>
                                        </Label>
                                        <CheckBox DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" IsChecked="{Binding TwitchChatBotAutoStart}" LostFocus="Settings_LostFocus" >
                                            <TextBlock>Auto-start when application starts</TextBlock>
                                        </CheckBox>
                                        <RadioButton DataContext="{Binding TwitchIO, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_StartBot" Content="Start Chat Bot" IsEnabled="False" PreviewMouseLeftButtonDown="RadioButton_StartBot_PreviewMoustLeftButtonDown"  />
                                        <RadioButton DataContext="{Binding TwitchIO, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_StopBot" Content="Stop Chat Bot" IsChecked="True" IsEnabled="False" PreviewMouseLeftButtonDown="RadioButton_StopBot_PreviewMoustLeftButtonDown" />
                                        <Label x:Name="Label_TwitchChat_Error" Foreground="Maroon" Visibility="Collapsed" Height="Auto">
                                            <TextBlock>The Twitch Chat Client failed to start! Check the Access Token Refresh Date and the Token Scope.</TextBlock>
                                        </Label>
                                        <StackPanel>
                                            <Label Height="Auto">
                                                <TextBlock TextWrapping="Wrap">Start and Stop bot when stream goes online! Depends on Live Monitor Bot being active and the detection time - when the stream is detected online is when the Chat Bot would start.</TextBlock>
                                            </Label>
                                            <CheckBox DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" IsChecked="{Binding TwitchChatBotConnectOnline}" LostFocus="Settings_LostFocus" >
                                                <TextBlock>Connect bot when stream goes online</TextBlock>
                                            </CheckBox>
                                            <CheckBox DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" IsChecked="{Binding TwitchChatBotDisconnectOffline}" LostFocus="Settings_LostFocus" >
                                                <TextBlock>Disconnect bot when stream goes offline</TextBlock>
                                            </CheckBox>
                                        </StackPanel>
                                    </WrapPanel>
                                </GroupBox>

                                <GroupBox Header="Clip Service">
                                    <WrapPanel>
                                        <Label x:Name="Label_TwitchClip_Start" Foreground="Green" Visibility="Collapsed">
                                            <TextBlock>The Twitch Clip Client is started!</TextBlock>
                                        </Label>
                                        <Label x:Name="Label_TwitchClip_Stop" Foreground="Maroon" Visibility="Visible">
                                            <TextBlock>The Twitch Clip Client is stopped!</TextBlock>
                                        </Label>
                                        <CheckBox DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" IsChecked="{Binding TwitchClipAutoStart}">
                                            <TextBlock>Auto-start when application starts</TextBlock>
                                        </CheckBox>
                                        <RadioButton DataContext="{Binding TwitchClip, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_ClipBotStart" Content="Start Clip Service Bot" IsEnabled="False" PreviewMouseLeftButtonDown="RadioButton_StartBot_PreviewMoustLeftButtonDown" />
                                        <RadioButton DataContext="{Binding TwitchClip, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_ClipBotStop" Content="Stop Clip Service Bot"  IsEnabled="False" IsChecked="True" PreviewMouseLeftButtonDown="RadioButton_StopBot_PreviewMoustLeftButtonDown" />
                                        <Label x:Name="Label_TwitchClip_Error" Foreground="Maroon" Visibility="Collapsed" Height="Auto">
                                            <TextBlock>The Twitch Clip Client failed to start! Check the Access Token Refresh Date and the Token Scope.</TextBlock>
                                        </Label>
                                    </WrapPanel>
                                </GroupBox>

                                <GroupBox Header="Pub Sub" Visibility="Visible">
                                    <StackPanel Orientation="Vertical">
                                        <WrapPanel>
                                            <WrapPanel.ToolTip>
                                                <TextBlock>The Twitch PubSub client establishes a constant connection with the server. For this reason, this service should be started and stopped only when it is needed.</TextBlock>
                                            </WrapPanel.ToolTip>
                                            <Label x:Name="Label_TwitchPubSub_Start" Foreground="Green" Visibility="Collapsed">
                                                <TextBlock>The Twitch PubSub Client is started!</TextBlock>
                                            </Label>
                                            <Label x:Name="Label_TwitchPubSub_Stop" Foreground="Maroon" Visibility="Visible">
                                                <TextBlock>The Twitch PubSub Client is stopped!</TextBlock>
                                            </Label>
                                            <RadioButton DataContext="{Binding TwitchBotPubSub, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_PubSubBotStart" Content="Start PubSub Service Bot" IsEnabled="False" PreviewMouseLeftButtonDown="RadioButton_StartBot_PreviewMoustLeftButtonDown" />
                                            <RadioButton DataContext="{Binding TwitchBotPubSub, Mode=OneWay, Source={StaticResource TwitchBot}}" x:Name="Radio_Twitch_PubSubBotStop" Content="Stop PubSub Service Bot"  IsEnabled="False" IsChecked="True" PreviewMouseLeftButtonDown="RadioButton_StopBot_PreviewMoustLeftButtonDown" />
                                        </WrapPanel>
                                        <GroupBox Width="Auto" Header="Services">
                                            <WrapPanel Orientation="Vertical">
                                                <Label>
                                                    <TextBlock>Selected Services will only be active when selected and then bot is started.</TextBlock>
                                                </Label>
                                                <CheckBox DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" IsChecked="{Binding TwitchPubSubChannelPoints}">
                                                    <TextBlock>Listen To Channel Point Events</TextBlock>
                                                </CheckBox>
                                            </WrapPanel>
                                        </GroupBox>
                                    </StackPanel>
                                </GroupBox>
                            </WrapPanel>
                        </StackPanel>
                    </TabItem>
                    <TabItem Header="Twitch">
                        <TabItem.Resources>
                            <Style TargetType="Label">
                                <Setter Property="Width" Value="120" />
                            </Style>
                            <Style TargetType="TextBox">
                                <Setter Property="Width" Value="250" />
                                <Setter Property="Height" Value="Auto" />
                                <Setter Property="TextWrapping" Value="Wrap" />
                                <EventSetter Event="PreviewMouseLeftButtonUp" Handler="PreviewMouseLeftButton_SelectAll" />
                                <EventSetter Event="PreviewMouseLeftButtonDown" Handler="PreviewMouseLeftButton_SelectAll" />
                                <EventSetter Event="LostFocus" Handler="Settings_LostFocus" />
                            </Style>
                        </TabItem.Resources>
                        <ScrollViewer ScrollViewer.VerticalScrollBarVisibility="Auto" PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                            <WrapPanel HorizontalAlignment="Left" Width="Auto" Height="Auto" DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" ScrollViewer.CanContentScroll="True" ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto">
                                <GroupBox Header="Bot Account" Width="Auto" DockPanel.Dock="Left">
                                    <StackPanel>
                                        <TextBlock x:Uid="ExpiredToken" x:Name="TextBlock_ExpiredCredentialsMsg" Foreground="#FFF71553" FontSize="18" HorizontalAlignment="Center" MaxWidth="550" TextAlignment="Center" Visibility="Collapsed" Text="{DynamicResource ExpiredToken}" />
                                        <StackPanel Orientation="Horizontal" Margin="10">
                                            <Label Content="Channel Name" />
                                            <TextBox x:Name="TB_Twitch_Channel" Text="{Binding TwitchChannelName}" SourceUpdated="TextBox_SourceUpdated" />
                                        </StackPanel>
                                        <TextBlock Width="300" Text="* This Chat Bot only supports communicating to one channel through the Channel Name." TextWrapping="Wrap" FontSize="8" FontStretch="SemiCondensed" />
                                        <StackPanel Orientation="Horizontal" Margin="10">
                                            <Label Content="Bot User Name" />
                                            <TextBox x:Name="TB_Twitch_BotUser" Text="{Binding TwitchBotUserName, Mode=TwoWay}" SourceUpdated="TextBox_SourceUpdated" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="10">
                                            <Button x:Name="Btn_Twitch_RefreshDate" Content="Refresh Due Date" Width="110" ToolTip="Click this button to set a 60 day due date from today, to show when the 'access token' needs refreshed." Click="RefreshButton_Click" LostFocus="Settings_LostFocus" />
                                            <Label x:Name="Label_Twitch_RefreshDate" Width="Auto" Content="{Binding TwitchRefreshDate, FallbackValue=1/1/1900, Mode=TwoWay, StringFormat=MM/dd/yyyy}"  />
                                        </StackPanel>
                                        <Expander x:Name="Expander_Credentials" Header="Credentials (Click me)" ExpandDirection="Down" IsExpanded="False">
                                            <StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="10">
                                                    <Label Content="Client Id" />
                                                    <TextBox x:Name="TB_Twitch_ClientID" Text="{Binding TwitchClientID, Mode=TwoWay}" ToolTip="The client ID for the bot user account." SourceUpdated="TextBox_SourceUpdated" />
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="10,0">
                                                    <Label Content="Token Scope" />
                                                    <TextBox x:Name="TextBox_TwitchScopesDiffOauthBot" BorderBrush="Blue" BorderThickness="1" IsReadOnly="True" SourceUpdated="TextBox_SourceUpdated" Text="{DynamicResource CredentialsTwitchScopesDiffOauthBot}" />
                                                    <TextBox x:Name="TextBox_TwitchScopesOauthSame" BorderBrush="Blue" BorderThickness="1" IsReadOnly="True" Visibility="Collapsed" SourceUpdated="TextBox_SourceUpdated" Text="{DynamicResource CredentialsTwitchScopesOauthSame}" />
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="10">
                                                    <Label Content="Access OAuth Token" />
                                                    <TextBox x:Name="TB_Twitch_AccessToken" Text="{Binding TwitchAccessToken, Mode=TwoWay}" SourceUpdated="TextBox_SourceUpdated" />
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="10">
                                                    <Label Content="Refresh Token"  />
                                                    <TextBox x:Name="TB_Twitch_RefreshToken" Text="{Binding TwitchRefreshToken, Mode=TwoWay}" SourceUpdated="TextBox_SourceUpdated" />
                                                </StackPanel>

                                            </StackPanel>
                                        </Expander>
                                    </StackPanel>
                                </GroupBox>

                                <GroupBox x:Name="GroupBox_Twitch_AdditionalStreamerCredentials" Header="Streamer Channel Credentials" Width="Auto" Visibility="Collapsed">
                                    <StackPanel>
                                        <TextBlock Text="{DynamicResource CredentialsTwitchExplainSameChannel}" Width="400"/>
                                        <StackPanel Orientation="Horizontal" Margin="10">
                                            <TextBlock x:Uid="ExpiredToken" x:Name="TextBlock_ExpiredStreamerCredentialsMsg" Foreground="#FFF71553" FontSize="18" HorizontalAlignment="Center" MaxWidth="550" TextAlignment="Center" Visibility="Collapsed" Text="{DynamicResource ExpiredToken}" />
                                            <Button x:Name="Btn_Twitch_RefreshDate_Streamer" Content="Refresh Due Date" Width="110" ToolTip="Click this button to set a 60 day due date from today, to show when the 'access token' needs refreshed." Click="RefreshStreamButton_Click" LostFocus="Settings_LostFocus" />
                                            <Label x:Name="Label_Twitch_StreamerRefreshDate" Width="Auto" Content="{Binding TwitchStreamerTokenDate, FallbackValue=1/1/1900, Mode=TwoWay, StringFormat=MM/dd/yyyy}" />
                                        </StackPanel>

                                        <TextBlock>Current Bot Features requiring the same {Bot and Streamer} Channel Client ID</TextBlock>
                                        <ListView ItemsSource="{DynamicResource CredentialsTwitchStreamerFeatures}" />

                                        <Expander Header="Streamer Channel Specific Credentials (Click Me)">
                                            <StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="10">
                                                    <Label Content="Client Id:"/>
                                                    <TextBox TextWrapping="Wrap" Text="{Binding TwitchStreamClientId, Mode=TwoWay}"  ToolTip="Client Id - saved in the settings. Bot uses the streamer channel defined in 'Channel Name'." SourceUpdated="TextBox_SourceUpdated" />
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="10">
                                                    <Label Content="Token Scope" />
                                                    <TextBox BorderBrush="Blue" BorderThickness="1" SourceUpdated="TextBox_SourceUpdated" Text="{DynamicResource CredentialsTwitchScopesDiffOauthChannel}" />
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="10">
                                                    <Label Content="Access OAuth Token"/>
                                                    <TextBox TextWrapping="Wrap" Text="{Binding TwitchStreamOauthToken, Mode=TwoWay}" SourceUpdated="TextBox_SourceUpdated" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Expander>
                                    </StackPanel>
                                </GroupBox>

                                <StackPanel>
                                    <GroupBox Header="Setup Follower Operations" Width="Auto">
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <Label Width="Auto" Content="Seconds between checking for new follows:"/>
                                                <Label Width="Auto" Content="{Binding Value, ElementName=Slider_TimeFollowerPollSeconds}" />
                                            </StackPanel>
                                            <Slider x:Name="Slider_TimeFollowerPollSeconds" Height="40" Width="407" AutoToolTipPlacement="TopLeft" Interval="1" TickPlacement="Both" ToolTip="Choose how often, in seconds, to check for new followers. Smaller values increases traffic to your channel." Value="{Binding TwitchFrequencyFollow, Mode=TwoWay}" Maximum="300" Minimum="5" SmallChange="1" SelectionStart="5" SelectionEnd="300" Margin="10,0" IsSnapToTickEnabled="True" LostFocus="Settings_LostFocus" LargeChange="50" TickFrequency="5" />
                                        </StackPanel>
                                    </GroupBox>
                                    <GroupBox Header="Setup Clip Operations" Width="Auto">
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <Label Width="Auto" Content="Seconds between checking for new follows:"/>
                                                <Label Width="Auto" Content="{Binding Value, ElementName=Slider_TimeClipPollSeconds}" />
                                            </StackPanel>
                                            <Slider x:Name="Slider_TimeClipPollSeconds" Height="40" Width="407" AutoToolTipPlacement="TopLeft" Interval="1" TickPlacement="Both" ToolTip="Choose how often, in seconds, to check for new clips. Smaller values increases traffic to your channel." Value="{Binding TwitchFrequencyClipTime, Mode=TwoWay}" Maximum="1200" Minimum="5" SmallChange="1" SelectionStart="5" SelectionEnd="1200" Margin="10,0" IsSnapToTickEnabled="True" LostFocus="Settings_LostFocus" LargeChange="50" TickFrequency="5"  />
                                        </StackPanel>
                                    </GroupBox>
                                    <GroupBox Header="Setup Go-Live Notifications" Width="Auto">
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <Label Width="Auto" Content="Seconds between checking for going live: " />
                                                <Label Width="Auto" Content="{Binding Value, ElementName=Slider_TimeGoLivePollSeconds}" />
                                            </StackPanel>
                                            <Slider x:Name="Slider_TimeGoLivePollSeconds" Height="40" Width="407" AutoToolTipPlacement="TopLeft" Interval="1" TickPlacement="Both" ToolTip="Choose how often, in seconds, to check for a change in channel state: going live, updated stream, and going offline. Smaller values increases traffic to your channel." Value="{Binding TwitchGoLiveFrequency, Mode=TwoWay}" Maximum="3600" Minimum="5" SmallChange="10" SelectionStart="5" SelectionEnd="3600" Margin="10,0" IsSnapToTickEnabled="True" LostFocus="Settings_LostFocus" LargeChange="100" TickFrequency="10"  />
                                        </StackPanel>
                                    </GroupBox>
                                </StackPanel>
                                <Expander Header="{DynamicResource CredentialsHeader}" IsExpanded="{Binding CredentialsHelpExpanded, Mode=OneWay}" ScrollViewer.CanContentScroll="True" Width="500">
                                    <FlowDocumentScrollViewer Margin="10" VerticalScrollBarVisibility="Auto" ScrollViewer.CanContentScroll="True">
                                        <FlowDocument FontSize="12" PagePadding="5">
                                            <Section>
                                                <Paragraph>
                                                    <Run Text="{DynamicResource CredentialsIntro}"/>
                                                    <LineBreak/>
                                                    <LineBreak/>
                                                    <Run Text="{DynamicResource CredentialsSettings}"/>
                                                </Paragraph>
                                                <Paragraph>
                                                    <Run Text="{DynamicResource CredentialsOAuth}"/>
                                                    <LineBreak />
                                                    <LineBreak />
                                                    <Run Text="{DynamicResource CredentialsOAuthManual}"/>
                                                </Paragraph>
                                            </Section>
                                            <Section>
                                                <List>
                                                    <ListItem>
                                                        <Paragraph>
                                                            <Run Text="{DynamicResource CredentialsBotAccount}"/>
                                                        </Paragraph>
                                                    </ListItem>
                                                    <ListItem>
                                                        <Paragraph>
                                                            <Run Text="{DynamicResource CredentialsVisit}"/>
                                                            <InlineUIContainer>
                                                                <TextBox Padding="2" IsReadOnly="True"  BorderBrush="Blue" BorderThickness="1" PreviewMouseLeftButtonUp="PreviewMouseLeftButton_SelectAll" PreviewMouseLeftButtonDown="PreviewMouseLeftButton_SelectAll" Text="{DynamicResource CredentialsLinkTwitchConsole}"/>
                                                            </InlineUIContainer>
                                                            <Run Text="{DynamicResource CredentialsTwitchAppRegister}"/>
                                                        </Paragraph>
                                                        <List>
                                                            <ListItem>
                                                                <Paragraph>
                                                                    <Run Text="{DynamicResource CredentialsTwitchAppName}"/>
                                                                </Paragraph>
                                                            </ListItem>
                                                            <ListItem>
                                                                <Paragraph>
                                                                    <Run Text="Add:"/>
                                                                    <LineBreak />
                                                                    <InlineUIContainer>
                                                                        <TextBox Padding="2" IsReadOnly="True"  BorderBrush="Blue" BorderThickness="1" PreviewMouseLeftButtonUp="PreviewMouseLeftButton_SelectAll" PreviewMouseLeftButtonDown="PreviewMouseLeftButton_SelectAll" Text="{DynamicResource CredentialsLinkTwitchTokenGen}"/>
                                                                    </InlineUIContainer>
                                                                    <Run Text="{DynamicResource CredentialsTwitchAcctOAuthRedirect}"/>
                                                                </Paragraph>
                                                            </ListItem>
                                                            <ListItem>
                                                                <Paragraph>
                                                                    <Run Text="{DynamicResource CredentialsTwitchAppCreate}"/>
                                                                </Paragraph>
                                                            </ListItem>
                                                            <ListItem>
                                                                <Paragraph>
                                                                    <Run Text="{DynamicResource CredentialsTwitchClientId}"/>
                                                                </Paragraph>
                                                            </ListItem>
                                                        </List>
                                                    </ListItem>
                                                    <ListItem>
                                                        <Paragraph>
                                                            <Run Text="{DynamicResource CredentialsAccessTokens}"/>
                                                            <InlineUIContainer>
                                                                <TextBox Padding="2" IsReadOnly="True"  BorderBrush="Blue" BorderThickness="1" PreviewMouseLeftButtonUp="PreviewMouseLeftButton_SelectAll" PreviewMouseLeftButtonDown="PreviewMouseLeftButton_SelectAll" Text="{DynamicResource CredentialsLinkTwitchTokenGen}"/>
                                                            </InlineUIContainer>
                                                        </Paragraph>
                                                        <List>
                                                            <ListItem>
                                                                <Paragraph>
                                                                    <Run Text="{DynamicResource CredentialsTwitchPasteClientId}"/>
                                                                    <Italic>
                                                                        <Run Text="{DynamicResource CredentialsLinkTwitchConsole}"/>
                                                                    </Italic>
                                                                    <Run Text=" ."/>
                                                                </Paragraph>
                                                            </ListItem>
                                                            <ListItem>
                                                                <Paragraph>
                                                                    <Run Text="{DynamicResource CredentialsTwitchPasteScopes}"/>
                                                                    <LineBreak />
                                                                    <Rectangle Fill="Black" Width="400" Height="3" HorizontalAlignment="Center" />
                                                                    <InlineUIContainer>
                                                                        <StackPanel x:Name="Help_TwitchBot_DiffAuthScopes_Bot">
                                                                            <Label Width="Auto">Bot account not equal to Streamer Channel - Bot Token Scopes</Label>
                                                                            <TextBox Padding="2" IsReadOnly="True"  BorderBrush="Blue" BorderThickness="1" TextWrapping="Wrap" PreviewMouseLeftButtonUp="PreviewMouseLeftButton_SelectAll" PreviewMouseLeftButtonDown="PreviewMouseLeftButton_SelectAll"  Text="{DynamicResource CredentialsTwitchScopesDiffOauthBot}"/>
                                                                        </StackPanel>
                                                                    </InlineUIContainer>
                                                                    <InlineUIContainer>
                                                                        <StackPanel x:Name="Help_TwitchBot_DiffAuthScopes_Streamer">
                                                                            <Label Width="Auto">Bot account not equal to Streamer Channel - Streamer Token Scopes</Label>
                                                                            <TextBox Padding="2" IsReadOnly="True"  BorderBrush="Blue" BorderThickness="1" TextWrapping="Wrap" PreviewMouseLeftButtonUp="PreviewMouseLeftButton_SelectAll" PreviewMouseLeftButtonDown="PreviewMouseLeftButton_SelectAll"  Text="{DynamicResource CredentialsTwitchScopesDiffOauthChannel}"/>
                                                                        </StackPanel>
                                                                    </InlineUIContainer>
                                                                    <InlineUIContainer>
                                                                        <StackPanel x:Name="Help_TwitchBot_SameAuthScopes">
                                                                            <Label Width="Auto">Bot account and Streamer Channel account the same - Token Scopes</Label>
                                                                            <TextBox Padding="2" IsReadOnly="True"  BorderBrush="Blue" BorderThickness="1" TextWrapping="Wrap" PreviewMouseLeftButtonUp="PreviewMouseLeftButton_SelectAll" PreviewMouseLeftButtonDown="PreviewMouseLeftButton_SelectAll"  Text="{DynamicResource CredentialsTwitchScopesOauthSame}"/>
                                                                        </StackPanel>
                                                                    </InlineUIContainer>
                                                                    <Rectangle Fill="Black" Width="400" Height="3" HorizontalAlignment="Center" />
                                                                    <LineBreak />
                                                                    <Run Text="{DynamicResource CredentialsTwitchScopesExplained}"/>
                                                                </Paragraph>
                                                            </ListItem>
                                                            <ListItem>
                                                                <Paragraph>
                                                                    <Run Text="{DynamicResource CredentialsTwitchAcctConnectClientIds}"/>
                                                                </Paragraph>
                                                            </ListItem>
                                                            <ListItem>
                                                                <Paragraph>
                                                                    <Run Text="{DynamicResource CredentialsTwitchRefreshDate}"/>
                                                                </Paragraph>
                                                            </ListItem>
                                                        </List>
                                                    </ListItem>
                                                </List>
                                            </Section>
                                        </FlowDocument>
                                    </FlowDocumentScrollViewer>
                                </Expander>

                            </WrapPanel>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>
            </TabItem>
            <TabItem Header="Data" DataContext="{Binding Mode=OneWay, Source={StaticResource DataViews}}">
                <DockPanel>
                    <TabControl>
                        <TabItem x:Name="TabItem_DataOptions" Header="Options">
                            <TabItem.Resources>
                                <Style TargetType="{x:Type StackPanel}">
                                    <Setter Property="Margin" Value="5" />
                                </Style>
                            </TabItem.Resources>
                            <ScrollViewer ScrollViewer.VerticalScrollBarVisibility="Auto">
                                <DockPanel Margin="10" DataContext="{Binding Source={x:Static s:Settings.Default}}" HorizontalAlignment="Center" ScrollViewer.CanContentScroll="True">
                                    <WrapPanel Orientation="Horizontal">
                                        <GroupBox Header="Any - Bot Management">
                                            <StackPanel>
                                                <CheckBox IsChecked="{Binding MsgBotConnection}">
                                                    <TextBlock>Enable bot welcome message when connected to stream channel.</TextBlock>
                                                </CheckBox>
                                                <CheckBox IsChecked="{Binding PostMultiLive}">
                                                    <TextBlock>Enable posting to social media (e.g. Discord) multiple live messages in same day.</TextBlock>
                                                </CheckBox>
                                                <CheckBox x:Name="CheckBox_Debug_Livestream" IsChecked="{Binding DebugLiveStream}">
                                                    <TextBlock>Enable Livestream debug buttons.</TextBlock>
                                                </CheckBox>
                                                <CheckBox IsChecked="{Binding ManageClearButtonEnabled}">
                                                    <CheckBox.ToolTip>
                                                        <TextBlock>This should mitigate accidental button clicks on the GUI when moving the mouse around, e.g. during a live stream.</TextBlock>
                                                    </CheckBox.ToolTip>
                                                    <TextBlock>Enable 'Clear Data' buttons.</TextBlock>
                                                </CheckBox>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Any - Automatic Commands by Timer">
                                            <StackPanel Margin="5">
                                                <CheckBox x:Name="CheckBox_RepeatCommands_Enable" IsChecked="{Binding RepeatTimerCommands, Mode=TwoWay}" Checked="CheckBox_Checked_PanelVisibility" Unchecked="CheckBox_Checked_PanelVisibility">
                                                    <CheckBox.ToolTip>
                                                        <TextBlock>Add 'seconds' (whole number, e.g. 600) to the repeat timer column within the command list. Timer updates after the command runs.</TextBlock>
                                                    </CheckBox.ToolTip>
                                                    <TextBlock>Enable repeating commands.</TextBlock>
                                                </CheckBox>
                                                <StackPanel x:Name="StackPanel_RepeatCommands_RepeatOptions" Visibility="Collapsed" Loaded="CheckBox_Checked_PanelVisibility" Margin="0,0,0,0">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="44" />
                                                            <RowDefinition Height="43" />
                                                            <RowDefinition Height="8" />
                                                            <RowDefinition Height="47" />
                                                            <RowDefinition />

                                                        </Grid.RowDefinitions>
                                                        <CheckBox IsChecked="{Binding RepeatWhenLive, Mode=TwoWay}" Grid.Row="0" Margin="5,5,5,5">
                                                            <TextBlock><Run Text="Perform Repeat commands only when live."/></TextBlock>
                                                        </CheckBox>

                                                        <CheckBox IsChecked="{Binding RepeatTimerComSlowdown, Mode=TwoWay}" Grid.Row="1" Margin="5,5,5,5">
                                                            <CheckBox.ToolTip>
                                                                <TextBlock>The repeating commands will slow down by up to 2x the specified time. The commands will return/unwind to normal speed when chat is very active. The specs for normal operation speed are about: at least 15+ viewers per half hour or over 20 viewer chats in 15 minutes.</TextBlock>
                                                            </CheckBox.ToolTip>
                                                            <TextBlock>Enable smart slow-down repeating commands</TextBlock>
                                                        </CheckBox>
                                                        <Line Fill="Black" StrokeThickness="1" Stroke="Black" X2="200"  Grid.Row="2" Margin="-1,0,-1,0"/>
                                                        <CheckBox IsChecked="{Binding RepeatLiveReset, Mode=TwoWay}" Grid.Row="3" Margin="5,5,5,5">
                                                            <CheckBox.ToolTip>
                                                                <TextBlock Width="200">The repeating commands continually run while the chat bot is active. The repeat timers will fire at their designated time as indicated by the 'repeat timer' and 'category' (of the stream - repeat commands can be specific to certain categories or 'All' for any stream). This setting resets the next fire event to the current time when the bot detects the stream is online.</TextBlock>
                                                            </CheckBox.ToolTip>
                                                            <TextBlock>Enable reset repeat timers when stream is online</TextBlock>
                                                        </CheckBox>
                                                        <CheckBox IsChecked="{Binding RepeatLiveResetShow, Mode=TwoWay}" Grid.Row="4" Margin="5,5,5,5">
                                                            <CheckBox.ToolTip>
                                                                <TextBlock>Coupled with the above 'Enable reset repeat timers when stream is online' option, this option permits whether the commands will perform upon the timer reset or not.</TextBlock>
                                                            </CheckBox.ToolTip>
                                                            <TextBlock>Enable showing repeat timer command when timers reset and stream is online.</TextBlock>
                                                        </CheckBox>
                                                        <TextBlock Visibility="Collapsed">TODO: add option spot for bot AI responses to encourage streamer when chatting is slow, and back away when stream has faster chatting.</TextBlock>
                                                    </Grid>
                                                </StackPanel>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Any - Welcome Viewers">
                                            <StackPanel>
                                                <Label Content="Only once per user per active stream (no repeats)" />
                                                <RadioButton IsChecked="{Binding WelcomeDisabled, Mode=TwoWay}">
                                                    <TextBlock Text="{DynamicResource Disabled}" />
                                                </RadioButton>
                                                <RadioButton IsChecked="{Binding FirstUserJoinedMsg, Mode=TwoWay}">
                                                    <TextBlock Text="Enable when viewer joins the channel" />
                                                </RadioButton>
                                                <RadioButton IsChecked="{Binding FirstUserChatMsg, Mode=TwoWay}">
                                                    <TextBlock Text="Enable when a viewer first chats" />
                                                </RadioButton>
                                                <CheckBox IsChecked="{Binding MsgWelcomeStreamer, Mode=TwoWay}">
                                                    <TextBlock Text="Enable welcome message when streamer chats" />
                                                </CheckBox>
                                                <Line Fill="Black" StrokeThickness="1" Stroke="Black" X2="200" HorizontalAlignment="Center" />
                                                <TextBlock Text="Customize Welcome Messages - Welcome New Viewer, Returning Viewer, and Followers/Subscribers" />
                                                <CheckBox IsChecked="{Binding WelcomeCustomMsg, Mode=TwoWay}">
                                                    <TextBlock Text="Enable" />
                                                </CheckBox>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Any - Media Overlay">
                                            <StackPanel>
                                                <CheckBox IsChecked="{Binding MediaOverlayEnabled}" >
                                                    <TextBlock>Enable Media Overlay</TextBlock>
                                                </CheckBox>
                                                <CheckBox IsChecked="{Binding MediaOverlayChannelPoints}" >
                                                    <CheckBox.ToolTip>The PubService bot must have 'Monitor Channel Points' service and bot started to enable this feature.</CheckBox.ToolTip>
                                                    <TextBlock>Enable Monitor Channel Points</TextBlock>
                                                </CheckBox>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Any - Moderate Follows">
                                            <StackPanel>
                                                <CheckBox x:Name="CheckBox_ModFollower_BanEnable" IsChecked="{Binding TwitchFollowerAutoBanBots}" Checked="CheckBox_Checked_PanelVisibility" Unchecked="CheckBox_Checked_PanelVisibility">
                                                    <StackPanel>
                                                        <TextBlock >
                                                            <TextBlock.TextDecorations>
                                                                <TextDecoration Location="Strikethrough"/>
                                                            </TextBlock.TextDecorations>Enable auto-banning Follow bots</TextBlock>
                                                        <TextBlock>
                                                            Currently sends "ban candidates" to the "Status Log" - to test and ensure real users are not accidentally banned.
                                                        </TextBlock>
                                                    </StackPanel>
                                                </CheckBox>
                                                <StackPanel x:Name="StackPanel_ModerateFollowers_Count" Orientation="Vertical" Visibility="Hidden" Loaded="CheckBox_Checked_PanelVisibility">
                                                    <TextBlock>When Follow-bot looks every N seconds, total new follows are detected at one time. A cluster can indicate a follow-bot attack (or you're very popular).</TextBlock>

                                                    <StackPanel Orientation="Horizontal">
                                                        <Label>Choose (1 to 100):</Label>
                                                        <TextBox Width="40" Height="18" Text="{Binding TwitchFollowerAutoBanCount, Mode=TwoWay}" HorizontalContentAlignment="Center"  LostFocus="TextBox_Follower_LostFocus" PreviewMouseLeftButtonUp="PreviewMouseLeftButton_SelectAll" PreviewMouseLeftButtonDown="PreviewMouseLeftButton_SelectAll" />
                                                    </StackPanel>
                                                    <Slider Value="{Binding TwitchFollowerAutoBanCount, Mode=TwoWay}" Maximum="100" Minimum="1" IsSnapToTickEnabled="True" IsSelectionRangeEnabled="True" SelectionEnd="1" SelectionStart="1" SmallChange="1" TickPlacement="Both" LargeChange="5" />
                                                </StackPanel>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Any - Moderation Messages">
                                            <StackPanel>
                                                <CheckBox IsChecked="{Binding ModerateUserLearnMsgs}" Click="CheckBox_Click_SaveSettings">
                                                    <TextBlock>The bot records chat messages to learn if messages are good or bad - bannable/timeout worthy.</TextBlock>
                                                </CheckBox>
                                                <CheckBox IsChecked="{Binding ModerateUsersWarn}" Click="CheckBox_Click_SaveSettings">
                                                    <TextBlock>Provide chat message of probable moderator action.</TextBlock>
                                                </CheckBox>
                                                <CheckBox IsChecked="{Binding ModerateUsersAction}" Click="CheckBox_Click_SaveSettings">
                                                    <TextBlock>The bot performs the moderation action</TextBlock>
                                                </CheckBox>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Twitch - Format Bot messages">
                                            <StackPanel>
                                                <Label Content="/me changes message to all italics" />
                                                <RadioButton x:Uid="Disabled" IsChecked="{Binding MsgNoMe, Mode=TwoWay}" Content="{DynamicResource Disabled}" />
                                                <RadioButton IsChecked="{Binding MsgInsertMe, Mode=TwoWay}" Content="Enable /me for all commands" />
                                                <RadioButton IsChecked="{Binding MsgPerComMe, Mode=TwoWay}" Content="Enable /me per command" />
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Twitch - Follow Options">
                                            <StackPanel>
                                                <CheckBox IsChecked="{Binding TwitchAddFollowersStart, Mode=TwoWay}" ToolTip="Will also re-perform when clicking 'Stop Bot' then 'Start Bot'.">
                                                    <TextBlock TextWrapping="Wrap">Enable adding all followers when bot starts.</TextBlock>
                                                </CheckBox>
                                                <CheckBox IsChecked="{Binding TwitchPruneNonFollowers, Mode=TwoWay}" ToolTip="Will also re-perform when clicking 'Stop Bot' then 'Start Bot'.">
                                                    <TextBlock TextWrapping="Wrap">Enable action to remove non-followers from the Follower list when bot starts.</TextBlock>
                                                </CheckBox>

                                                <CheckBox x:Name="CheckBox_TwitchFollower_LimitMsgs" IsChecked="{Binding TwitchFollowerEnableMsgLimit}" Checked="CheckBox_Checked_PanelVisibility" Unchecked="CheckBox_Checked_PanelVisibility">Enable Limited Follower Messages</CheckBox>

                                                <StackPanel x:Name="StackPanel_TwitchFollower_LimitMsgs_Count" Orientation="Vertical" Visibility="Hidden" Loaded="CheckBox_Checked_PanelVisibility">
                                                    <TextBlock>Multiple messages can clutter chat, this will abbreviate the response to condense the messages.</TextBlock>

                                                    <StackPanel Orientation="Horizontal">
                                                        <Label>Choose (1 to 100):</Label>
                                                        <TextBox Width="40" Height="18" Text="{Binding TwitchFollowerMsgLimit, Mode=TwoWay}" HorizontalContentAlignment="Center" LostFocus="TextBox_Follower_LostFocus" PreviewMouseLeftButtonUp="PreviewMouseLeftButton_SelectAll" PreviewMouseLeftButtonDown="PreviewMouseLeftButton_SelectAll" />
                                                    </StackPanel>

                                                    <Slider Value="{Binding TwitchFollowerMsgLimit, Mode=TwoWay}" Maximum="100" Minimum="1" IsSnapToTickEnabled="True" IsSelectionRangeEnabled="True" SelectionEnd="1" SelectionStart="1" SmallChange="1" TickPlacement="Both" LargeChange="5" />
                                                </StackPanel>
                                                <CheckBox x:Name="CheckBox_TwitchFollower_AutoRefresh" IsChecked="{Binding TwitchFollowerAutoRefresh, Mode=TwoWay}" Checked="CheckBox_Checked_PanelVisibility" Unchecked="CheckBox_Checked_PanelVisibility">
                                                    <CheckBox.ToolTip>
                                                        <TextBlock>The Twitch API doesn't provide notices when someone unfollows. This refreshes follower list while bot is running - instead of restarting the Follow bot.</TextBlock>
                                                    </CheckBox.ToolTip>
                                                    <TextBlock>Enable Regular Follower Updatess</TextBlock>
                                                </CheckBox>
                                                <StackPanel x:Name="StackPanel_TwitchFollows_RefreshHrs" Orientation="Horizontal" Visibility="Hidden" Loaded="CheckBox_Checked_PanelVisibility">
                                                    <Label>Select Refresh Hours:</Label>
                                                    <ComboBox x:Name="ComboBox_TwitchFollower_RefreshHrs" Width="60" ToolTip="Select Frequency in Hours to Refresh Followers" SelectedValue="{Binding TwitchFollowerRefreshHrs, Mode=TwoWay}" SelectionChanged="ComboBox_TwitchFollower_RefreshHrs_SelectionChanged"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Twitch - Shout Out Viewers">
                                            <StackPanel>
                                                <Label>
                                                    <TextBlock>Active when channel is live</TextBlock>
                                                </Label>
                                                <CheckBox IsChecked="{Binding MsgAutoShout, Mode=TwoWay}">
                                                    <TextBlock>Auto shoutout viewers when they first appear (tied to 'Welcome Viewers'. Add names to &quot;Auto SO&quot; tab.)</TextBlock>
                                                </CheckBox>
                                                <CheckBox IsChecked="{Binding TwitchRaidShoutOut}">
                                                    <TextBlock>Enable auto shoutout for incoming channel raid streamers</TextBlock>
                                                </CheckBox>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Twitch - Stream Clips">
                                            <StackPanel>
                                                <CheckBox IsChecked="{Binding TwitchClipPostChat, Mode=TwoWay}">
                                                    <TextBlock>Post new clips to chat.</TextBlock>
                                                </CheckBox>
                                                <CheckBox IsChecked="{Binding TwitchClipPostDiscord}">
                                                    <TextBlock>Post new clips to Discord. Must have "Clips" Webhook(s) defined.</TextBlock>
                                                </CheckBox>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Twitch - Currency System">
                                            <StackPanel>
                                                <CheckBox IsChecked="{Binding TwitchCurrencyStart, Mode=TwoWay}">
                                                    <TextBlock>Enable Currency Accrual - still permits adding currencies</TextBlock>
                                                </CheckBox>
                                                <CheckBox x:Name="CheckBox_CurrencyOnline" IsChecked="{Binding TwitchCurrencyOnline, Mode=TwoWay}" Visibility="Collapsed">
                                                    <TextBlock>Enable Currency Accrual only when Streaming Online</TextBlock>
                                                </CheckBox>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Any - Data Management">
                                            <GroupBox.Resources>
                                                <Style BasedOn="{StaticResource {x:Type CheckBox}}" TargetType="{x:Type CheckBox}">
                                                    <EventSetter Event="Click" Handler="CheckBox_ManageData_Click" />
                                                </Style>
                                            </GroupBox.Resources>
                                            <StackPanel>
                                                <Label>
                                                    <TextBlock Foreground="Red">*Unchecking will remove data from database.*</TextBlock>
                                                </Label>
                                                <CheckBox x:Name="CheckBox_ManageUsers" IsChecked="{Binding ManageUsers}">
                                                    <TextBlock TextWrapping="Wrap">Manage channel viewers, including their watchtime.*</TextBlock>
                                                </CheckBox>
                                                <CheckBox x:Name="CheckBox_ManageFollowers" IsChecked="{Binding ManageFollowers}">
                                                    <TextBlock TextWrapping="Wrap">Manage channel followers, including their followage. Requires User data.*</TextBlock>
                                                </CheckBox>
                                                <CheckBox x:Name="CheckBox_ManageStreamStat" IsChecked="{Binding ManageStreamStats}">
                                                    <TextBlock TextWrapping="Wrap">Record Stream Stats for each stream, including the categories table.*</TextBlock>
                                                </CheckBox>
                                                <CheckBox x:Name="CheckBox_ManageRaidData" IsChecked="{Binding ManageRaidData}">
                                                    <TextBlock TextWrapping="Wrap">Record Raid Stats for incoming raids.*</TextBlock>
                                                </CheckBox>
                                                <CheckBox x:Name="CheckBox_ManageOutRaidData" IsChecked="{Binding ManageOutRaidData}">
                                                    <TextBlock TextWrapping="Wrap">Record outgoing raids.*</TextBlock>
                                                </CheckBox>
                                                <CheckBox x:Name="CheckBox_ManageGiveawayUsers" IsChecked="{Binding ManageGiveawayUsers}">
                                                    <TextBlock TextWrapping="Wrap">Record Giveaway data results.*</TextBlock>
                                                </CheckBox>
                                                <Label>
                                                    <TextBlock Foreground="Red">*Unchecking will remove data from database.*</TextBlock>
                                                </Label>
                                            </StackPanel>
                                        </GroupBox>

                                        <!-- Settings Template                                
                                            <GroupBox Header="Twitch -">
                                                <StackPanel>
                                                    <CheckBox IsChecked="{Binding AutoShout, Mode=TwoWay}" >
                                                        <TextBlock>Auto </TextBlock>
                                                    </CheckBox>
                                                    <CheckBox IsChecked="{Binding TwitchRaidShoutOut}" >
                                                        <TextBlock>Enable </TextBlock>
                                                    </CheckBox>
                                                </StackPanel>
                                            </GroupBox>
                                            -->

                                    </WrapPanel>
                                </DockPanel>
                            </ScrollViewer>
                        </TabItem>
                        <TabItem Header="Variables">
                            <ListView DockPanel.Dock="Right" DataContext="{Binding Mode=OneWay, Source={StaticResource CommandInfo}}" ItemsSource="{Binding Collection}" >
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn DisplayMemberBinding="{Binding Parameter}" Header="Parameter" Width="150"/>
                                        <GridViewColumn DisplayMemberBinding="{Binding Value}" Header="Value" />
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </TabItem>
                        <TabItem Header="Discord">
                            <DockPanel LastChildFill="True">
                                <TextBlock IsEnabled="False" DockPanel.Dock="Top">Add Webhook links, one per line. Bot will report notifications to each Webhook. *The incorrect 'Kind' will prevent the notification.<LineBreak />
                                Use 'AddEveryone'=true (checkmark) to replace #everyone with @everyone, but 'AddEveryone'=false removes 'everyone' from message, some servers don't permit full notification tagging.<LineBreak />
                                </TextBlock>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" DockPanel.Dock="Top" Margin="0,0,0,10">
                                    <Button x:Name="Button_DiscordWebhooks_Enabled" Width="80" Margin="10,0" Content="Enable All" Click="Button_DiscordWebhooks_Click" />
                                    <Button x:Name="Button_DiscordWebhooks_Disabled" Width="80" Content="Disable All" Click="Button_DiscordWebhooks_Click" />
                                </StackPanel>
                                <DataGrid x:Name="DG_Webhooks" DockPanel.Dock="Top" ItemsSource="{Binding Discord, Mode=OneWay}" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                            </DockPanel>
                        </TabItem>
                        <TabItem Header="Moderation">
                            <DockPanel>
                                <TextBlock DockPanel.Dock="Top" MinWidth="150">Use this tab to manage bot moderation settings, such as banning users based on their chat messages or chat activity. To identify a message for action, the bot needs a group of similar messages so a new message can be reviewed and identified. <LineBreak />
                                This procedure uses Machine Learning (hence the 'training'); and uses "BagOfWords" to convert messages (strings into number vectors) such that the "Naive Bayes" classifier can probabilistically determine if a message falls within the same range of trained messages already identified as spam or harrassment. <LineBreak /> <Run Foreground="Red">Caution, the messages of hate and spam need to be included here so similar message can be identified as hate or spam.</Run></TextBlock>

                                <DockPanel DockPanel.Dock="Top" MaxHeight="150">
                                    <DataGrid Height="250" ItemsSource="{Binding BanReasons}" CanUserDeleteRows="True" DockPanel.Dock="Left" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    <DataGrid Height="250" ItemsSource="{Binding BanRules}" CanUserDeleteRows="True" DockPanel.Dock="Right" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    <TextBlock>
                                        Timeout is marked in seconds, min is 1 and max is 1,209,600 (2 weeks). <LineBreak />
                                        When 'ModAction' is set to 'Ban', the timeout isn't used. <LineBreak />
                                        It's probable sometimes messages from long term followers/users are a little more tolerable than new arrivals, options provided for to help with this.
                                    </TextBlock>
                                </DockPanel>

                                <DataGrid ItemsSource="{Binding LearnMsgs}" DockPanel.Dock="Bottom" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                            </DockPanel>
                        </TabItem>
                        <TabItem Header="User Data" x:Name="TabItem_Users">
                            <TabControl>
                                <TabItem Header="User Follow">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition MinWidth="600" Width="600*" />
                                            <ColumnDefinition Width="5" />
                                            <ColumnDefinition MinWidth="400" Width="400*" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Row="0" Content="User List"/>
                                        <Button x:Name="Button_ClearNonFollowers" Content="Clear Non-Followers" Height="20" Width="120" Click="Button_ClearNonFollowers_Click">
                                            <Button.ToolTip>
                                                <TextBlock>Remove all non-Followers from User listing. The comparison is "Id" field, not "IsFollower" status.</TextBlock>
                                            </Button.ToolTip>
                                        </Button>
                                        <Button x:Name="Button_ClearWatchTime" Content="Reset All WatchTime" Grid.Row="0" Height="20" Width="120" Click="Button_ClearWatchTime_Click" HorizontalAlignment="Right" Margin="0,0,15,0" />
                                        <Label Grid.Row="0" Grid.Column="2" Content="Follower List" />
                                        <DataGrid x:Name="DG_Users" ItemsSource="{Binding Users, Mode=OneWay}" Grid.Row="1" Grid.Column="0" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />

                                        <DataGrid x:Name="DG_Followers" ItemsSource="{Binding Followers, Mode=OneWay}" Grid.Row="1" Grid.Column="2" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    </Grid>
                                </TabItem>
                                <TabItem Header="Auto-SO">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="85" />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="320" />
                                            <ColumnDefinition Width="5"/>
                                            <ColumnDefinition Width="350*" />
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Row="0">
                                            <TextBlock TextWrapping="Wrap" Text="When 'Auto shout out' is enabled in options, displaynames in this list will receive a shout-out upon entering the channel - when Twitch tells me they're here."/>
                                            <Button Width="250" Height="20" Content="Shout these Users if in Chat" Margin="10,10,10,10" Click="ShoutUsers_Click"/>
                                        </StackPanel>

                                        <DataGrid Grid.Row="1" ItemsSource="{Binding ShoutOuts, Mode=OneWay}"  ContextMenuOpening="DG_Edit_ContextMenuOpening" />

                                        <TextBlock Grid.Row="0" Grid.Column="2" Text="Specify a custom message per UserName, tied to Welcome Message options - first appearance or first message. Otherwise, system falls back onto default." />
                                        <DataGrid x:Name="DG_CustomWelcome" Grid.Row="1" Grid.Column="2" ItemsSource="{Binding CustomWelcomeData, Mode=OneWay}" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    </Grid>
                                </TabItem>
                                <TabItem Header="Currency" x:Name="TabItem_CurrencyAccrual">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="65" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="320"/>
                                            <ColumnDefinition Width="5"/>
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <Label Grid.Row="0" Grid.ColumnSpan="3">
                                            <TextBlock Width="744">Specify Currency Type (left side) to accrue per user (right side). Specify Amount earned for Seconds of time (e.g. earn 5 every 10 seconds). Any updates are prospective (starts from now) and not retrospective (doesn't award currency for the past).</TextBlock>
                                        </Label>
                                        <Button x:Name="Button_ClearCurrencyAccrlValues" Grid.Column="2" Height="20" Width="147" Content="Clear All Currency Values" VerticalAlignment="Center" HorizontalAlignment="Right" Click="Button_ClearCurrencyAccrlValues_Click" />
                                        <DataGrid x:Name="DG_Currency" ItemsSource="{Binding CurrencyType, Mode=OneWay}" AutoGeneratedColumns="DG_AutoGeneratedColumns" Grid.Row="1" Grid.Column="0" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                        <DataGrid x:Name="DG_CurrencyAccrual" ItemsSource="{Binding Currency, Mode=OneWay}" AutoGeneratedColumns="DG_AutoGeneratedColumns" Grid.Row="1" Grid.Column="2" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    </Grid>
                                </TabItem>
                                <TabItem Header="Giveaways" x:Name="TabItem_Giveaways" Loaded="TabItem_Giveaways_Loaded">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="50" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="250*" />
                                            <ColumnDefinition Width="400" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0">Setup Giveaways! <LineBreak />Be sure to start "Twitch Chat Client" bot to read channel points, viewer entries, and provide giveaway details and winner(s) to viewers.</TextBlock>

                                        <DockPanel Grid.Row="1" Grid.Column="0" HorizontalAlignment="Center" DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}">
                                            <DockPanel.Resources>
                                                <Style TargetType="Label">
                                                    <Setter Property="Width" Value="160" />
                                                </Style>
                                                <Style TargetType="TextBox">
                                                    <Setter Property="Width" Value="250"/>
                                                    <Setter Property="Height" Value="18" />
                                                </Style>
                                            </DockPanel.Resources>
                                            <GroupBox DockPanel.Dock="Top" Header="Select Giveaway Condition" Width="Auto" VerticalAlignment="Top">
                                                <GroupBox.ToolTip>Select the &quot;Command&quot; or &quot;Channel Points&quot; item a viewer uses to enter the giveaway.</GroupBox.ToolTip>
                                                <StackPanel>
                                                    <RadioButton x:Name="RadioButton_GiveawayCommand" VerticalContentAlignment="Center">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Label Width="100">Command</Label>
                                                            <ComboBox x:Name="ComboBox_Giveaway_Coms" MinWidth="200" DataContext="{Binding Mode=OneWay, Source={StaticResource DataViews}}" ItemsSource="{Binding CommandCollection, Mode=OneWay}" PreviewMouseLeftButtonDown="ComboBox_Giveaway_PreviewMouseLeftButtonDown" DropDownClosed="ComboBox_Giveaway_DropDownClosed" />
                                                        </StackPanel>
                                                    </RadioButton>
                                                    <RadioButton x:Name="RadioButton_GiveawayCustomRewards" VerticalContentAlignment="Center">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Label Width="100">Channel Points</Label>
                                                            <ComboBox x:Name="ComboBox_Giveaway_ChanPts" MinWidth="200" PreviewMouseLeftButtonDown="ComboBox_Giveaway_PreviewMouseLeftButtonDown" DropDownClosed="ComboBox_Giveaway_DropDownClosed" />
                                                            <Button x:Name="Button_Giveaway_RefreshChannelPoints" Margin="5,0" Height="21" Padding="5,2" Content="Refresh" Click="Button_Giveaway_RefreshChannelPoints_Click" />
                                                        </StackPanel>
                                                    </RadioButton>
                                                </StackPanel>
                                            </GroupBox>
                                            <StackPanel DockPanel.Dock="Top" Margin="5" Orientation="Horizontal">
                                                <CheckBox  Content="Allow more than 1 entry" IsChecked="{Binding GiveawayMultiUser}" />
                                                <Label Margin="50,0,0,0" Width="Auto" Content="Max Entries" />
                                                <TextBox Width="40" Text="{Binding GiveawayMaxEntries}" ToolTip="Can be changed during giveaway, lowered will remove excess entrants." HorizontalContentAlignment="Center" />
                                            </StackPanel>
                                            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Center">
                                                <StackPanel.Resources>
                                                    <Style TargetType="Button">
                                                        <Setter Property="Padding" Value="5,0" />
                                                        <Setter Property="Margin" Value="5,3"/>
                                                    </Style>
                                                </StackPanel.Resources>
                                                <Button x:Name="Button_GiveawayBegin" Content="Begin Giveaway" Click="Button_GiveawayBegin_Click" IsEnabled="False">
                                                    <Button.ToolTip>
                                                        <TextBlock>The ChatBot needs to be started for chatting Giveaway messages. PubSub Bot needs to be started for Channel Points redemption to be detected.</TextBlock>
                                                    </Button.ToolTip>
                                                </Button>
                                                <Button x:Name="Button_GiveawayEnd" Content="End Giveaway" Click="Button_GiveawayEnd_Click" IsEnabled="False" />
                                                <Button x:Name="Button_GiveawayPickWinner" Content="Pick Winners" Click="Button_GiveawayPickWinner_Click" IsEnabled="False" />
                                            </StackPanel>
                                            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                                                <Label>Number of Winners:</Label>
                                                <TextBox Width="30" HorizontalContentAlignment="Center" Text="{Binding GiveawayCount, Mode=TwoWay}" LostFocus="CheckBox_Click_SaveSettings">
                                                    <TextBox.ToolTip>
                                                        <TextBlock>Specify how many viewers to select for the giveaway event.</TextBlock>
                                                    </TextBox.ToolTip>
                                                </TextBox>
                                            </StackPanel>
                                            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                                                <Label>Giveaway start message:</Label>
                                                <TextBox Text="{Binding GiveawayBegMsg, Mode=TwoWay}" LostFocus="CheckBox_Click_SaveSettings"/>
                                            </StackPanel>
                                            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                                                <Label>Giveaway end message:</Label>
                                                <TextBox Text="{Binding GiveawayEndMsg, Mode=TwoWay}" LostFocus="CheckBox_Click_SaveSettings"/>
                                            </StackPanel>
                                            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                                                <Label>Winner Message (#winner):</Label>
                                                <TextBox Text="{Binding GiveawayWinMsg, Mode=TwoWay}" LostFocus="CheckBox_Click_SaveSettings">
                                                    <TextBox.ToolTip>
                                                        <TextBlock>Use #user to include the name in the Giveaway announcement text.</TextBlock>
                                                    </TextBox.ToolTip>
                                                </TextBox>
                                            </StackPanel>
                                            <StackPanel DockPanel.Dock="Top" Margin="0,10,0,2" Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Label Content="Current Giveaway Entrants:" />
                                                <Label Width="Auto" DataContext="{Binding Mode=OneWay, Source={StaticResource DataViews}}" Content="{Binding GiveawayCollection.Count, Mode=OneWay}"  />
                                            </StackPanel>
                                            <ListView DockPanel.Dock="Top" x:Name="listView" Width="300" DataContext="{Binding Mode=OneWay, Source={StaticResource DataViews}}" ItemsSource="{Binding GiveawayCollection}">
                                                <ListView.View>
                                                    <GridView>
                                                        <GridViewColumn Header="Order" Width="50" DisplayMemberBinding="{Binding RelativeSource={RelativeSource FindAncestor, 
                                         AncestorType={x:Type ListViewItem}}, 
                                         Converter={StaticResource IndexConverter}}"
                                                                        />
                                                        <GridViewColumn Header="Entrant" Width="220" DisplayMemberBinding="{Binding Mode=OneWay}" />
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>

                                        </DockPanel>

                                        <TextBlock Grid.Row="0" Grid.Column="1">Results of prior Giveaways recorded here! <LineBreak /> Data management is enabled or disabled in the Options tab.</TextBlock>
                                        <DataGrid Grid.Row="1" Grid.RowSpan="2" Grid.Column="1" DataContext="{Binding Mode=OneWay, Source={StaticResource DataViews}}" ItemsSource="{Binding GiveawayUserData, Mode=OneWay}" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    </Grid>
                                </TabItem>
                            </TabControl>
                        </TabItem>
                        <TabItem Header="System Events">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="70" />
                                    <RowDefinition Height="100*" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Row="0" Margin="5">
                                    <TextBlock>Double-click the MsgStr for your custom message. Use the 'Commands' to customize to a name or relevant values.<LineBreak/>'Live' is a message to Discord/other services.</TextBlock>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button x:Name="Button_SystemEvents_Enabled" Width="80" Margin="10,0" Content="Enable All" Click="Button_SystemEvents_Click"/>
                                        <Button x:Name="Button_SystemEvents_Disabled" Width="80" Content="Disable All" Click="Button_SystemEvents_Click" />
                                    </StackPanel>
                                </StackPanel>
                                <DataGrid x:Name="DG_CommonMsgs" ItemsSource="{Binding ChannelEvents, Mode=OneWay}"  AutoGeneratedColumns="DG_AutoGeneratedColumns" Grid.Row="1" Grid.Column="2" CanUserDeleteRows="False" ContextMenuOpening="DG_Edit_ContextMenuOpening">
                                    <DataGrid.ToolTip>
                                        <TextBlock TextWrapping="Wrap" Width="500"><Run Text="The name column is readonly. These are for channel events the bot recognizes and responds with the specified message."/><LineBreak /><LineBreak /><Run Text="You can edit the message to customize a response fitting your channel!"/><LineBreak /><Run Text="Please see the parameters to the right to use in each message, not all will be applicable. Ensure a space before the parameter, e.g. &quot;the #user followed&quot;, the &quot; #&quot; needs to be the first character in the word."/></TextBlock>
                                    </DataGrid.ToolTip>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                        <TabItem Header="Commands">
                            <TabControl>
                                <TabItem Header="Help">
                                    <StackPanel Orientation="Vertical">
                                        <TextBlock><Run Text="The 'BuiltInCommands' are those established within the bot."/><LineBreak /><Run Text="The 'socials' (specific services): add your custom message for the social media and your access URL. E.g. &quot;Visit me on Twitter at: http://wwww.twitter.com/myuser&quot;. The command will show all socials except messages that are blank or the default 'Social media url here'."/><LineBreak /><LineBreak /><Run Text="The variables within message to format a custom response:"/><LineBreak /><Run Text="#user: the user specific to the command; either 'command invoker' user or parameter to the command"/><LineBreak /><Run Text="#url: the Twitch URL with the supplied user attached - specific to 'so == shoutout' command"/><LineBreak /><Run Text="#fieldvalue: placeholder for the value from a table lookup"/><LineBreak /><Run Text="#currencyname: placeholder for the currency name - extracted from table"/><LineBreak /><Run Text="#currencyvalue: the value of a currency"/><LineBreak /><LineBreak /><Run Text="#date: the current date"/><LineBreak /><Run Text="#time: the current time"/><LineBreak /></TextBlock>
                                        <Rectangle Width="800" Fill="Black" Stretch="Fill" Stroke="Black" Height="1" />
                                        <StackPanel Orientation="Horizontal">
                                            <Label Content="Viewer Type Values: " />
                                            <TextBlock Text="{Binding ViewerTypesValues, Mode=OneWay, Source={StaticResource ViewerTypesString}}" FlowDirection="LeftToRight" ToolTip="ViewerTypes for Command access rights" VerticalAlignment="Center" />
                                        </StackPanel>

                                        <Label Content="A value to the right permits access with the leftward values, e.g. selecting 'VIP' allows 'VIP, Mod, Broadcaster' access rights. "/>
                                    </StackPanel>
                                </TabItem>
                                <TabItem Header="Built-In">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <StackPanel Grid.Row="0">
                                            <TextBlock Margin="5">To use command repeat timers, set option in 'Option' tab and set the *seconds* within the command row. This repeat doesn't work with those commands requiring parameters. The '!socials', for example, is an ideal repeat command. 1 minute = 60 seconds, 10 minutes = 600 seconds, 15 minutes = 900 seconds, 30 minutes = 1800 seconds, 1 hour = 3600 seconds. Top can be '0' for a single item, '-1' for all items, and 'n' (positive integer) for the top n items as defined by 'sort = ASC or DESC.</TextBlock>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button x:Name="Button_BuiltInCommands_Enabled" Width="80" Margin="10,0" Content="Enable All" Click="Button_BuiltInCommands_Click" />
                                                <Button x:Name="Button_BuiltInCommands_Disabled" Width="80" Content="Disable All" Click="Button_BuiltInCommands_Click" />
                                            </StackPanel>
                                        </StackPanel>

                                        <DockPanel Grid.Row="1">
                                            <Label DockPanel.Dock="Top" Content="Built-in Commands:" />
                                            <DataGrid DockPanel.Dock="Top" x:Name="DG_BuiltInCommands" ItemsSource="{Binding BuiltInCommands, Mode=OneWay}" AutoGeneratedColumns="DG_AutoGeneratedColumns" CanUserDeleteRows="False" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                        </DockPanel>
                                    </Grid>
                                </TabItem>
                                <TabItem Header="User-Defined">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>

                                        <StackPanel Grid.Row="0">
                                            <TextBlock Margin="5">To use command repeat timers, set option in 'Option' tab and set the *seconds* within the command row. This repeat doesn't work with those commands requiring parameters. The '!socials', for example, is an ideal repeat commands. 1 minute = 60 seconds, 10 minutes = 600 seconds, 15 minutes = 900 seconds, 30 minutes = 1800 seconds, 1 hour = 3600 seconds. Top can be '0' for a single item, '-1' for all items, and 'n' (positive integer) for the top n items as defined by 'sort = ASC or DESC"</TextBlock>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button x:Name="Button_UserDefinedCommands_Enabled" Width="80" Margin="10,0" Content="Enable All" Click="Button_UserDefinedCommands_Click" />
                                                <Button x:Name="Button_UserDefinedCommands_Disabled" Width="80" Content="Disable All" Click="Button_UserDefinedCommands_Click" />
                                            </StackPanel>
                                        </StackPanel>

                                        <DockPanel Grid.Row="1">
                                            <Label DockPanel.Dock="Top" Content="User-Defined Commands:" />
                                            <DataGrid x:Name="DG_UserDefinedCommands" DockPanel.Dock="Top" ItemsSource="{Binding Commands, Mode=OneWay}" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                        </DockPanel>
                                    </Grid>
                                </TabItem>
                            </TabControl>
                        </TabItem>
                        <TabItem Header="Overlays" Name="TabItem_Overlays">

                        </TabItem>
                        <TabItem Header="Stream Data" x:Name="TabItem_StreamData">
                            <TabControl>
                                <TabItem x:Name="TabItem_StreamData_Stats" Header="Stats">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <StackPanel x:Name="StackPanel_DebugLivestream" Orientation="Horizontal" Grid.Row="0">
                                            <Button Content="Add Random Test Stream" Height="20" Margin="10,0" ToolTip="Will activate in debug mode, won't post to social media." Click="StartDebugStream_Click"/>
                                            <Button Content="Stop Random Test Stream" Height="20" Margin="10,0" Click="EndDebugStream_Click" />
                                        </StackPanel>
                                        <DataGrid x:Name="DataGrid_StreamData_Stats" Grid.Row="1" ItemsSource="{Binding StreamStats, Mode=OneWay}" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    </Grid>
                                </TabItem>
                                <TabItem Header="Raids">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="55" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="550" />
                                            <ColumnDefinition Width="5" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0">This table saves incoming raids to your channel, so you can show them any additional appreciation after your stream. Category indicates what they were streaming.</TextBlock>
                                        <TextBlock Grid.Row="0" Grid.Column="2">This table saves outgoing raids from your channel, so you know the channels you've raided and can spread the love.</TextBlock>


                                        <DataGrid Grid.Row="1" ItemsSource="{Binding InRaidData, Mode=OneWay}" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                        <DataGrid Grid.Row="1" Grid.Column="2" ItemsSource="{Binding OutRaidData, Mode=OneWay}" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    </Grid>
                                </TabItem>
                                <TabItem Header="Categories" x:Name="TabItem_Category">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="450"/>
                                            <ColumnDefinition Width="5"/>
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <DataGrid x:Name="DG_CategoryList_Clips" ItemsSource="{Binding Category, Mode=OneWay}" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    </Grid>
                                </TabItem>
                                <TabItem Header="Clips" x:Name="TabItem_Clips">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Row="0" Content="Clip List"/>
                                        <DataGrid x:Name="DG_Clips" ItemsSource="{Binding Clips, Mode=OneWay}" Grid.Row="1" AutoGeneratedColumns="DG_AutoGeneratedColumns" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                    </Grid>
                                </TabItem>
                            </TabControl>
                        </TabItem>
                        <TabItem x:Name="TabItem_Data_Separator" IsEnabled="False" MinWidth="20" Width="20" />
                        <TabItem x:Name="TabItem_Data_MultiLive" Header="MultiLive Monitor">
                            <Grid x:Name="TabItem_MultiUserLiveMonitor" IsEnabled="False">
                                <Grid.Resources>
                                    <Style BasedOn="{StaticResource {x:Type DataGrid}}" TargetType="DataGrid">
                                        <Setter Property="Margin" Value="5"/>
                                        <Setter Property="MaxColumnWidth" Value="160" />
                                        <Setter Property="CanUserAddRows" Value="True" />
                                        <Setter Property="CanUserDeleteRows" Value="True" />
                                    </Style>
                                </Grid.Resources>
                                <Grid.DataContext>
                                    <Binding Mode="OneWay" Path="TwitchLiveMonitor" Source="{StaticResource TwitchBot}"/>
                                </Grid.DataContext>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="50" />
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="298*" />
                                    <ColumnDefinition Width="52"/>
                                    <ColumnDefinition Width="100"  />
                                    <ColumnDefinition Width="52"/>
                                    <ColumnDefinition Width="293*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock TextWrapping="Wrap" Grid.Row="0" Padding="3"><Run Text="Use this tab to set up which channels (only first 100) to watch for going live and where to post messages. Currently only Discord."/></TextBlock>
                                <Label Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="3" Foreground="Red" Visibility="{Binding Visibility, ElementName=Label_LiveStream_MultiLiveActiveMsg}">
                                    <TextBlock TextWrapping="Wrap"><Run Text="The MultiUserLiveBot is active, single channel activated."/></TextBlock>
                                </Label>
                                <TextBlock TextWrapping="Wrap" Grid.Row="0" Grid.Column="4" Text="Message for Live Notification:" />
                                <TextBox x:Name="TB_LiveMsg" Grid.Row="0" Grid.Column="4" VerticalContentAlignment="Top" 
                             DataContext="{Binding Mode=OneWay, Source={x:Static s:Settings.Default}}" Text="{Binding MsgLive}" 
                             TextAlignment="Left" TextWrapping="Wrap" LostFocus="Settings_LostFocus" Margin="0,16,0,0">
                                    <TextBox.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="#user" Click="MenuItem_Click" />
                                            <MenuItem Header="#category" Click="MenuItem_Click" />
                                            <MenuItem Header="#title" Click="MenuItem_Click" />
                                            <MenuItem Header="#url" Click="MenuItem_Click" />
                                        </ContextMenu>
                                    </TextBox.ContextMenu>
                                    <TextBox.ToolTip>
                                        <TextBlock><Run Text="Use these tags within the message and it'll be replaced before sending the posted live message."/><LineBreak /><Run Text="Available by right-click menu - insert at cursor."/><LineBreak /><Run Text="&quot;#user&quot; - channel name of the user"/><LineBreak /><Run Text="&quot;#category&quot; - the category of the stream"/><LineBreak /><Run Text="&quot;#title&quot; - the title of the stream when it goes live"/><LineBreak /><Run Text="&quot;#url&quot; - to send someone to the Twitch channel, it's already prepared &quot; twitch.tv/user &quot;"/><LineBreak /><LineBreak /><Run Text="Example: @everyone, #user is now live streaming #category - #title! Come join and say hi at: #url"/></TextBlock>
                                    </TextBox.ToolTip>
                                </TextBox>

                                <DataGrid x:Name="DG_Multi_WebHooks" Grid.Row="1" Grid.RowSpan="2" DataContext="{Binding MultiLiveDataManager}" ItemsSource="{Binding MsgEndPoints, Mode=OneWay}" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                <DataGrid x:Name="DG_Multi_ChannelNames" Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="3" DataContext="{Binding MultiLiveDataManager}" ItemsSource="{Binding Channels, Mode=OneWay}" ContextMenuOpening="DG_Edit_ContextMenuOpening" />
                                <DataGrid x:Name="DG_Multi_LiveStreamStats" Grid.Column="4" Grid.Row="1" Grid.RowSpan="2" DataContext="{Binding MultiLiveDataManager}" ItemsSource="{Binding LiveStream, Mode=TwoWay}" IsEnabled="False" ContextMenuOpening="DG_Edit_ContextMenuOpening" />

                                <DockPanel x:Name="Panel_BotActivity" Grid.Row="1" Grid.Column="4" Visibility="Collapsed">
                                    <Label DockPanel.Dock="Top" Content="Log of Bot Activity:" />
                                    <TextBox DockPanel.Dock="Bottom" x:Name="TB_BotActivityLog" Margin="5" TextWrapping="Wrap" Background="#FFEEEEEE" ScrollViewer.VerticalScrollBarVisibility="Auto" IsReadOnly="True" VerticalScrollBarVisibility="Visible" IsInactiveSelectionHighlightEnabled="True" TextChanged="TB_BotActivityLog_TextChanged" Text="{Binding MultiLiveStatusLog}"  />
                                </DockPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </DockPanel>
            </TabItem>
            <TabItem Header="Logs">
                <TabControl>
                    <TabItem Header="Bot Status" DataContext="{DynamicResource AppStats}" >
                        <TabItem.Resources>
                            <DataTemplate x:Key="AppStatTemplate">
                                <StackPanel Orientation="Horizontal">
                                    <Label Width="250" Content="{Binding Name}" />
                                    <Label Width="200" Content="{Binding Value, Converter={StaticResource AppDataConverter}}" />
                                </StackPanel>
                            </DataTemplate>
                            <Style TargetType="ListViewItem">
                                <Setter Property="ContentTemplate" Value="{StaticResource AppStatTemplate}" />
                            </Style>
                        </TabItem.Resources>
                        <ListView BorderBrush="#FF36373A" BorderThickness="2,2,1,2" Padding="5">
                            <ListViewItem Content="{Binding Path=Header}" BorderThickness="0,0,0,1" BorderBrush="#FF191717" />
                            <ListViewItem Content="{Binding Path=Threads}" />
                            <ListViewItem Content="{Binding Path=ClosedThreads}" />
                            <ListViewItem Content="{Binding Path=Uptime}" />
                        </ListView>
                    </TabItem>
                    <TabItem Header="Twitch Status" GotFocus="TabItem_GotFocus">
                        <GroupBox Header="Bot Status Log" BorderBrush="Black" Width="Auto">
                            <DockPanel>
                                <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" DataContext="{Binding Source={x:Static s:Settings.Default}}">
                                    <CheckBox IsChecked="{Binding LogBotStatus}" Content="Enable Bot Status Logging" Margin="3" ToolTip="Save this log - 'StatusLog.txt'"/>
                                    <CheckBox IsChecked="{Binding LogExceptions}" Content="Enable TwineBot Exception Logging" Margin="3" ToolTip="Save Exceptions - 'ExceptionsLog.txt'"/>
                                </StackPanel>
                                <TextBox x:Name="TextBlock_TwitchBotLog" DataContext="{Binding TwitchIO, Mode=OneWay, Source={StaticResource TwitchBot}}" Text="{Binding StatusLog, Mode=OneWay}" TextWrapping="Wrap" Width="Auto" Background="#FFEEEEEE" ScrollViewer.VerticalScrollBarVisibility="Auto" IsReadOnly="True" VerticalScrollBarVisibility="Visible" IsInactiveSelectionHighlightEnabled="True" TextChanged="TextBox_TwitchBotLog_TextChanged" />
                            </DockPanel>
                        </GroupBox>
                    </TabItem>
                </TabControl>
            </TabItem>
            <TabItem Header="Bot Chat" Height="30" Margin="-2,0,0,0" VerticalAlignment="Bottom">
                <DockPanel>
                    <DockPanel LastChildFill="True" DockPanel.Dock="Left" Margin="0,0,10,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25" />
                                <RowDefinition Height="25"/>
                                <RowDefinition Height="100"/>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Label Grid.Row="0" Content="Join List to organize playing games with your viewers." HorizontalContentAlignment="Center" Grid.RowSpan="3" />
                            <Label Grid.Row="1" Content="Click the 'remove' box next to the user name to remove from this list." HorizontalContentAlignment="Center" Grid.RowSpan="3" />
                            <GroupBox Grid.Row="2" Padding="10" Header="Join List Status"  >
                                <StackPanel DataContext="{Binding Source={x:Static s:Settings.Default}}">
                                    <StackPanel.Resources>
                                        <Style BasedOn="{StaticResource {x:Type RadioButton}}" TargetType="{x:Type RadioButton}">
                                            <Setter Property="Margin" Value="3" />
                                        </Style>
                                    </StackPanel.Resources>
                                    <RadioButton IsChecked="{Binding UserPartyStart, Mode=TwoWay}" >Start Join List</RadioButton>
                                    <RadioButton IsChecked="{Binding UserPartyStop, Mode=TwoWay}" >Stop Join List</RadioButton>
                                </StackPanel>
                            </GroupBox>
                            <ListView Grid.Row="3" x:Name="LV_JoinList" MaxWidth="500" DataContext="{Binding Source={StaticResource DataViews}}"
                                      ItemsSource="{Binding JoinCollection, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}" SelectionMode="Single" Margin="0,0,0,10">
                                <ListView.Resources>
                                    <DataTemplate x:Key="GridColCheck">
                                        <CheckBox IsChecked="{Binding Remove, Mode=TwoWay, NotifyOnTargetUpdated=True, UpdateSourceTrigger=PropertyChanged}" Checked="JoinCollectionCheckBox_Checked" AutomationProperties.IsRowHeader="False" />
                                    </DataTemplate>
                                </ListView.Resources>
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Remove" Width="70" CellTemplate="{DynamicResource GridColCheck}" />
                                        <GridViewColumn Header="GameTag UserName" Width="200" DisplayMemberBinding="{Binding GameUserName, Mode=OneWay, UpdateSourceTrigger=Default}" />
                                        <GridViewColumn Header="Chat User" Width="200" DisplayMemberBinding="{Binding ChatUser, Mode=OneWay, UpdateSourceTrigger=Default}" />
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </Grid>
                    </DockPanel>
                    <DockPanel LastChildFill="True" DockPanel.Dock="Right"  Background="#FF2B2929" >
                        <StackPanel Orientation="Horizontal" DockPanel.Dock="Bottom" Margin="5" Background="White" Width="410">
                            <Button Padding="10,4" Margin="10" Content="Pop-Out Chat Box" Click="PopOutChatButton_Click" Height="26" Opacity="1" IsEnabled="False" />
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <Label Padding="0" Content="Pop-out Opacity"/>
                                <TextBlock Text="50%"/>
                            </StackPanel>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" DockPanel.Dock="Bottom" HorizontalAlignment="Right" Margin="0,4,15,4">
                            <TextBox x:Name="TextBox_BotChat" Width="360" />
                            <Button Content="Send" Margin="10,0,0,0" Padding="8,2" Click="BotChat_SendButton_Click" />
                        </StackPanel>
                        <FlowDocumentScrollViewer DockPanel.Dock="Top" BorderThickness="1,1,1,1" x:Name="FlowDoc_ChatBox" ScrollViewer.CanContentScroll="True" DataContext="{Binding Mode=OneWay, Source={StaticResource DataViews}}" Document="{Binding ChatData, Mode=OneWay, NotifyOnSourceUpdated=True}" Foreground="#FFC5C3C3" />
                    </DockPanel>
                </DockPanel>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>
